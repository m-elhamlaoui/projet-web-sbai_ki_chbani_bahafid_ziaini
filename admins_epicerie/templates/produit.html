{% load static %}
<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="UTF-8">
    <!-- Favicon
    ============================================ -->
    <link rel="shortcut icon" type="image/png" href="{% static 'image/favicon-32x32.png' %}" />
    <title>GestEpice Admin</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
  
    <link rel="stylesheet" href="{% static 'css/stylePr.css' %}">
    <!-- Boxicons CDN Link -->
    <link href='https://unpkg.com/boxicons@2.0.7/css/boxicons.min.css' rel='stylesheet'>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css" integrity="sha512-MV7K8+y+gLIBoVD59lQIYicR65iaqukzvf/nwasF0nqhPay5w/9lJmVM2hMDcnK1OnMGCdVK+iQrJ7lzPJQd1w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    
  </head>
  <body>


  
{% include 'sidebar.html' %}




<section class="home-section">
    <nav>
        <div class="sidebar-button">
            <i class='bx bx-menu sidebarBtn'></i>
            <span class="dashboard">PRODUITS & CATEGORIES</span>
        </div>

        <div class="profile-details">
            <img src="./../static/image/{{ request.session.photo }}" alt="">
            <span class="admin_name">{{ request.session.nom }} {{ request.session.prenom }}</span>
            <i class='bx bx-chevron-down'></i>
        </div>
    </nav>

    <div class="home-content">
        <div class="overview-boxes">
            <div class="box">
                <div class="right-side">
                   
                        <div class="box-topic">CATEGORIE</div>
                    
                        <!-- Formulaire d'ajout de catÃ©gorie -->
                        <form action="" class="ProductEdits" id="ajoutCategorie">{% csrf_token %} {{ form.as_p }}
                            <div class="fromm">
                                <div class="elem">
                                    <label for="name">NOM</label>
                                    <input type="text" id="name" name="nom" required>
                                </div>
                            </div>
                            <br><br>
                            <div class="ssbmt">
                                <input class="submit" type="submit" value="Envoyer" style="background:#FC4400;color:white;font-weight:bold;">
                            </div>
                        </form>

                        <div style="background:#FF8000;color:white;font-weight:bold;border-radius:10px;opacity:0.7;" class="retour1 ssbmt"></div>

                        <div class="box-topic">PRODUITS</div>

                        <!-- Formulaire d'ajout de produit -->
                        <form action="" class="ProductEdits" id="ajoutProduit">{% csrf_token %} {{ form.as_p }}
                            <div class="fromm">
                                <div class="elem">
                                    <label for="name">NOM</label>
                                    <input type="text" id="name" name="nom" required>
                                </div>
                                <div class="elem">
                                    <label for="Description">DESCRIPTION</label>
                                    <textarea type="text" id="Description" name="description" required></textarea>
                                </div>
                                <div class="elem">
                                    <label for="prix">PRIX</label>
                                    <input type="number" min="1.00" id="prix" name="prix" required>
                                </div>
                                <div class="elem">
                                    <label for="prix">PRIX PROM</label>
                                    <input type="number" min="0.00" id="prix" name="prixPromotion" required>
                                </div>
                                <div class="elem">
                                    <label for="amount">QTE EN STOCK</label>
                                    <input type="number" min="1.00" max="10000.00" step="1" id="amount" name="qte" class="amount" required>
                                </div>
                                <div class="elem">
                                    <label for="amount">SEUIL MIN</label>
                                    <input type="number" min="0.00" max="10000.00" step="1" id="amount" name="seuil_min" class="amount" required>
                                </div>
                                <div class="elem">
                                    <label for="types">CATEGORIE</label>
                                    <select id="types" name="categorie" required>
                                        <option value="" selected="selected">Selectionner</option>
                                        {% for categorie in categories %}
                                            <option value="{{ categorie.id_categorie }}">{{ categorie.nom_categorie }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                                <div class="elem">
                                    <label for="types">PROPRIETAIRE</label>
                                    <select id="types" name="Proprietaire" required>
                                        <option value="OUI">EPICERIE</option>
                                        <option value="NON">ETUDIANT</option>
                                    </select>
                                </div>
                                <div class="elem">
                                    <label for="amount">NOM INPTISTE</label>
                                    <input type="text" name="auteur" class="amount">
                                </div>
                                <div class="elem">
                                    <label for="types">IMAGE</label>
                                    <input class="submit" type="file" value="upload" name="image" required>
                                </div>
                            </div>
                            <br><br>
                            <div class="ssbmt">
                                <input class="submit" type="submit" value="Envoyer" style="background:#FC4400;color:white;font-weight:bold;">
                            </div>
                        </form>

                        <div style="background:#FF8000;color:white;font-weight:bold;border-radius:10px;opacity:0.7;" class="retour ssbmt"></div>
                    
                </div>
            </div>
        </div>

        <div class="sales-boxes">
            <div class="recent-sales box">
                <label for="cars">CATEGORIE</label>
                <select id="types1">
                    <option value="" selected="selected">Selectionner</option>
                    {% for categorie in categories %}
                        <option value="{{ categorie.id_categorie }}">{{ categorie.nom_categorie }}</option>
                    {% endfor %}
                </select>
                <div class="sales-details" id="produitAdmin"></div>
            </div>

            <div class="top-sales box">
                <div class="title">PRODUITS LES PLUS VENDUS</div>
                <ul class="top-sales-details">
                    {% for meilleur in meilleurs_ventes %}
                        <li>
                            <a href="#">
                                <img src="./../../{{ meilleur.image_produit }}">
                                <span class="product">{{ meilleur.nom_produit }}</span>
                            </a>
                            <span class="date">{{ meilleur.prix_promotion }} DH</span>
                            <span class="price">{{ meilleur.total_vendu|default_if_none:"0" }}</span>
                        </li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>
</section>





<script type="text/javascript" src="{% static 'js/scriptAdmin.js' %}"></script>

<script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

<script src="{% static 'js/produit.js' %}"></script>

<script>

$(document).ready(function(){

        //Ajout categorie
    
        $("#ajoutCategorie").on('submit', function(e){
          e.preventDefault();
          $.ajax({
              type: 'POST',
              url: './../ajout_categorie/', 
              data: new FormData(this),
              dataType: 'json',
              contentType: false,
              cache: false,
              processData:false,
              success: function(reponse){
                  if(reponse == 0){
                      $("#ajoutCategorie")[0].reset();
                      $(".retour1").show();
                      $(".retour1").html("Categorie ajoute avec succes");
                      setTimeout(function(){$(".retour1").hide();},5000);
                  } else {
                      $(".retour1").show();
                      $(".retour1").html(reponse);
                      setTimeout(function(){$(".retour1").hide();},5000);
                  }
              }
          });
      });

});
</script>

  </body>
</html>